<!DOCTYPE html>
<html lang="es">
<head>
<title>28 - API fetch asyn await enviando un objeto formulario con POST</title>
<meta charset="UTF-8">
<meta nombre="viewport" content="width=deice-width, confial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
.container {
width: 800px;
}
</style>
</head>
<body>
<div class="container">
<h3>Formulario de inscripción</h3>
<form action="" method="post" id="formulario">
  <div class="mb-3 mt-3">
    <label for="nombre" class="form-label">Nombre:</label>
    <input type="nombre" class="form-control" id="nombre" name="nombre" placeholder="Introduce tu nombre" required>
  </div>
  <div class="mb-3 mt-3">
    <label for="dni" class="form-label">DNI:</label>
    <input type="dni" class="form-control" id="dni" name="dni" placeholder="Introduce tu dni" required>
  </div>
  <div class="mb-3 mt-3">
    <label for="correo" class="form-label">Correo:</label>
    <input type="email" class="form-control" id="correo" name="correo" placeholder="Introduce tu correo" required>
  </div>  
  <button type="submit" class="btn btn-primary" id="insertar">Inscribirse</button>
  <div id="form-msg" class=""></div>
</form>
</div>
<script>
const form = document.getElementById('formulario');

form.addEventListener('submit', function(event){
event.preventDefault();
//creamos una instancia desde la clase FormData
const objeto = new FormData(form);
//invocamos a la función
enviarFormulario(objeto);
});

async function enviarFormulario(objeto){
/* POST espera que la solicitud envíe valores dentro de body,  le pasamos el objeto creado con la clase FormData */
    const response = await fetch('inscripcion.php',{
        method: 'POST',
        body: objeto
    });
// respuesta del servidor en formato texto
   const respuesta = await response.text();
    let msg = document.getElementById("form-msg");
    msg.className += " alert alert-success";
    msg.innerHTML = respuesta;
}
</script>
</body>
</html>